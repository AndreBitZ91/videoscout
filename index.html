<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AT Analyzer Pro | Scouting de Andebol</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap');

        :root {
            --slate-950: #020617;
            --slate-900: #0f172a;
        }

        body {
            background-color: var(--slate-950);
            color: #f1f5f9;
            font-family: 'Inter', sans-serif;
            overflow: hidden;
        }

        .font-mono { font-family: 'JetBrains Mono', monospace; }

        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        .glass {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .court-gradient {
            background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%);
        }

        /* Custom range styling */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
            margin-top: -6px;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #1e293b;
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        import React, { useState, useRef, useEffect, useCallback, useMemo } from 'https://esm.sh/react@18.2.0';
        import ReactDOM from 'https://esm.sh/react-dom@18.2.0/client';
        import { 
            Play, Pause, Scissors, Download, Upload, Trash2, Tag, ChevronRight, Save, X, RotateCcw, 
            FolderInput, Plus, MinusCircle, FileSpreadsheet, CheckSquare, Square, Film, Loader2, 
            Clapperboard, MonitorPlay, Settings, UserPlus, Users, Shirt, Shield, Swords, FileJson, 
            SaveAll, Database, MapPin, BarChart2, Filter, PieChart, LayoutGrid, RefreshCw, FileVideo, 
            Terminal, Copy, PlaySquare, HelpCircle, TrendingUp, Target, Activity, AlertTriangle, Hand, 
            ListVideo, Command, Trophy, Clock, Flag, Timer, Edit, Pencil, ArrowUpRight, ArrowDownRight, 
            UserMinus, User, Image as ImageIcon, FileText, Calendar, Home, ArrowLeft, Globe, Search, 
            LayoutList, CheckCircle2, ChevronLeft, GraduationCap, Medal, Share2, MoreVertical
        } from 'https://esm.sh/lucide-react@0.263.1';

        // =========================================================================
        // ðŸ“¦ CONSTANTES E UTILITÃRIOS
        // =========================================================================
        const formatTime = (seconds) => {
            if (seconds === undefined || seconds === null || isNaN(seconds)) return "00:00.0";
            const m = Math.floor(seconds / 60);
            const s = Math.floor(seconds % 60);
            const ms = Math.floor((seconds % 1) * 10);
            return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}.${ms}`;
        };

        const getHeatmapColor = (efficiency) => {
            if (efficiency === null || efficiency === undefined) return "#1e293b"; 
            if (efficiency < 0.3) return "rgba(239, 68, 68, 0.8)";  // Red
            if (efficiency < 0.5) return "rgba(249, 115, 22, 0.8)"; // Orange
            if (efficiency < 0.7) return "rgba(234, 179, 8, 0.8)";  // Yellow
            return "rgba(34, 197, 94, 0.8)";                       // Green
        };

        const staticCategories = {
            "Resultado": ["Golo", "Defesa", "Fora", "Poste", "7 Metros"],
            "Turn Over": ["Falha TÃ©cnica", "IntercepÃ§Ã£o"],
            "Fase": ["Ofensiva", "Defensiva", "Contra-Ataque", "Retorno"]
        };
        const zones = ["Zona 1", "Zona 2", "Zona 3", "Zona 4", "Zona 5", "Zona 6", "Zona 7", "Zona 8"];

        // =========================================================================
        // ðŸ§© COMPONENTES UI REUTILIZÃVEIS
        // =========================================================================
        const Button = ({ children, onClick, variant = "primary", size = "md", className = "", icon: Icon }) => {
            const variants = {
                primary: "bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20 border border-blue-500",
                secondary: "bg-slate-800 hover:bg-slate-700 text-slate-200 border border-slate-700",
                danger: "bg-red-600 hover:bg-red-500 text-white shadow-lg shadow-red-900/20 border border-red-500",
                ghost: "hover:bg-slate-800 text-slate-400 hover:text-white",
                success: "bg-emerald-600 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-900/20 border border-emerald-500"
            };
            const sizes = { sm: "px-3 py-1.5 text-xs", md: "px-4 py-2 text-sm", lg: "px-6 py-3 text-base" };
            return React.createElement('button', {
                onClick,
                className: `flex items-center justify-center gap-2 rounded-lg font-bold transition-all active:scale-95 ${variants[variant]} ${sizes[size]} ${className}`
            }, Icon && React.createElement(Icon, { size: size === 'sm' ? 14 : 18 }), children);
        };

        const TagButton = ({ label, selected, onClick, color = "blue" }) => {
            const colors = {
                blue: selected ? "bg-blue-600 text-white border-blue-500 shadow-lg shadow-blue-900/50" : "bg-slate-900 text-slate-400 border-slate-700 hover:border-blue-500/50 hover:text-blue-300",
                green: selected ? "bg-emerald-600 text-white border-emerald-500 shadow-lg shadow-emerald-900/50" : "bg-slate-900 text-slate-400 border-slate-700 hover:border-emerald-500/50 hover:text-emerald-300",
                yellow: selected ? "bg-amber-500 text-slate-900 border-amber-400 shadow-lg shadow-amber-900/50" : "bg-slate-900 text-slate-400 border-slate-700 hover:border-amber-500/50 hover:text-amber-300",
                red: selected ? "bg-red-600 text-white border-red-500 shadow-lg shadow-red-900/50" : "bg-slate-900 text-slate-400 border-slate-700 hover:border-red-500/50 hover:text-red-300"
            };
            return React.createElement('button', {
                onClick,
                className: `px-3 py-1.5 rounded-lg text-xs font-bold border transition-all active:scale-95 ${colors[color]}`
            }, label);
        };

        const Card = ({ children, title, icon: Icon, className = "", extra }) => (
            React.createElement('div', { className: `bg-slate-900 border border-slate-800 rounded-xl overflow-hidden shadow-xl ${className}` },
                title && React.createElement('div', { className: "px-5 py-4 border-b border-slate-800 flex justify-between items-center bg-slate-900/50" },
                    React.createElement('h3', { className: "font-bold text-slate-200 flex items-center gap-2" }, Icon && React.createElement(Icon, { size: 18, className: "text-blue-500" }), title),
                    extra
                ),
                React.createElement('div', { className: "p-5" }, children)
            )
        );

        const Modal = ({ isOpen, onClose, title, children, maxWidth = "max-w-2xl" }) => {
            if (!isOpen) return null;
            return ReactDOM.createPortal(
                React.createElement('div', { className: "fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in" },
                    React.createElement('div', { className: `bg-slate-950 w-full ${maxWidth} rounded-2xl border border-slate-800 shadow-2xl overflow-hidden flex flex-col max-h-[90vh]` },
                        React.createElement('div', { className: "px-6 py-4 border-b border-slate-800 flex justify-between items-center bg-slate-900" },
                            React.createElement('h2', { className: "text-lg font-bold text-white" }, title),
                            React.createElement('button', { onClick: onClose, className: "p-2 hover:bg-slate-800 rounded-full transition-colors text-slate-400 hover:text-white" }, React.createElement(X, { size: 20 }))
                        ),
                        React.createElement('div', { className: "flex-1 overflow-y-auto" }, children)
                    )
                ),
                document.body
            );
        };

        const StatsCourt = ({ zoneStats = {} }) => {
            const renderZonePath = (zoneName, d, textX, textY) => {
                const stats = zoneStats[zoneName] || { shots: 0, goals: 0, efficiency: 0 };
                const hasShots = stats.shots > 0;
                const fillColor = hasShots ? getHeatmapColor(stats.efficiency) : "rgba(30, 41, 59, 0.4)";
                return React.createElement('g', { key: zoneName },
                    React.createElement('path', { d: d, fill: fillColor, stroke: "rgba(255,255,255,0.1)", strokeWidth: "1" }),
                    hasShots && React.createElement('text', { x: textX, y: textY, textAnchor: "middle", className: "text-[10px] fill-white font-bold pointer-events-none drop-shadow-md" }, `${Math.round(stats.efficiency * 100)}%`),
                    hasShots && React.createElement('text', { x: textX, y: parseFloat(textY) + 12, textAnchor: "middle", className: "text-[8px] fill-slate-300 font-mono pointer-events-none drop-shadow-md" }, `${stats.goals}/${stats.shots}`)
                );
            };
            return React.createElement('div', { className: "relative w-full aspect-[16/9] court-gradient rounded-xl border border-slate-700 overflow-hidden shadow-inner" },
                React.createElement('svg', { viewBox: "0 0 400 220", className: "w-full h-full" },
                    renderZonePath("Zona 8", "M 0,0 L 133,0 L 133,90 L 0,90 Z", "66", "45"),
                    renderZonePath("Zona 7", "M 133,0 L 266,0 L 266,90 L 133,90 Z", "200", "45"),
                    renderZonePath("Zona 6", "M 266,0 L 400,0 L 400,90 L 266,90 Z", "333", "45"),
                    renderZonePath("Zona 5", "M 0,90 L 60,90 L 60,220 L 0,220 Z", "30", "155"),
                    renderZonePath("Zona 4", "M 60,90 L 140,90 L 140,220 L 60,220 Z", "100", "155"),
                    renderZonePath("Zona 3", "M 140,90 L 260,90 L 260,220 L 140,220 Z", "200", "155"),
                    renderZonePath("Zona 2", "M 260,90 L 340,90 L 340,220 L 260,220 Z", "300", "155"),
                    renderZonePath("Zona 1", "M 340,90 L 400,90 L 400,220 L 340,220 Z", "370", "155"),
                    React.createElement('path', { d: "M 0,90 L 400,90", fill: "none", stroke: "rgba(255,255,255,0.2)", strokeWidth: "1", strokeDasharray: "5,5" }),
                    React.createElement('path', { d: "M 50,220 C 50,160 350,160 350,220", fill: "none", stroke: "rgba(255,255,255,0.3)", strokeWidth: "2" }),
                    React.createElement('rect', { x: "170", y: "215", width: "60", height: "5", fill: "#ef4444" })
                )
            );
        };

        // =========================================================================
        // ðŸŽ£ HOOKS DE DADOS (COM PROTEÃ‡ÃƒO CONTRA FALHAS)
        // =========================================================================
        const useStorage = () => {
            const getSafeItem = (key, defaultVal) => {
                try {
                    const item = localStorage.getItem(key);
                    return item ? JSON.parse(item) : defaultVal;
                } catch (error) {
                    console.error(`Erro ao ler ${key} do LocalStorage. Resetando.`, error);
                    return defaultVal;
                }
            };

            const [teams, setTeams] = useState(() => getSafeItem('ata_teams_v3', []));
            const [games, setGames] = useState(() => getSafeItem('ata_games_v3', []));
            const [comps, setComps] = useState(() => getSafeItem('ata_comps_v3', []));

            useEffect(() => {
                try { localStorage.setItem('ata_teams_v3', JSON.stringify(teams)); } catch (e) { console.error("Quota exceeded", e); }
            }, [teams]);
            
            useEffect(() => {
                try { localStorage.setItem('ata_games_v3', JSON.stringify(games)); } catch (e) { console.error("Quota exceeded", e); }
            }, [games]);
            
            useEffect(() => {
                try { localStorage.setItem('ata_comps_v3', JSON.stringify(comps)); } catch (e) { console.error("Quota exceeded", e); }
            }, [comps]);

            return { teams, setTeams, games, setGames, comps, setComps };
        };

        // =========================================================================
        // ðŸ  DASHBOARD VIEW & SUB-COMPONENTS
        // =========================================================================
        const Dashboard = ({ onSelectGame, storage }) => {
            const { games, teams, comps, setGames, setTeams, setComps } = storage;
            const [activeTab, setActiveTab] = useState('games');
            const [isNewGameOpen, setIsNewGameOpen] = useState(false);
            const [newGame, setNewGame] = useState({ compId: '', teamAId: '', teamBId: '', date: new Date().toISOString().split('T')[0] });

            const sortedGames = useMemo(() => [...games].sort((a,b) => new Date(b.date || 0) - new Date(a.date || 0)), [games]);

            const handleCreateGame = () => {
                if (!newGame.compId || !newGame.teamAId || !newGame.teamBId) return alert("Preenche todos os campos!");
                if (newGame.teamAId === newGame.teamBId) return alert("As equipas devem ser diferentes!");

                const comp = comps.find(c => c.id === newGame.compId);
                const tA = teams.find(t => t.id === newGame.teamAId);
                const tB = teams.find(t => t.id === newGame.teamBId);
                
                const game = {
                    id: Date.now().toString(),
                    compId: newGame.compId,
                    compName: comp.name,
                    season: comp.season,
                    date: newGame.date,
                    teamA: { id: tA.id, name: tA.name, logo: tA.logo, players: tA.players || [] },
                    teamB: { id: tB.id, name: tB.name, logo: tB.logo, players: tB.players || [] },
                    clips: []
                };
                setGames([...games, game]);
                setIsNewGameOpen(false);
                onSelectGame(game.id);
            };

            const handleDeleteGame = (e, id) => {
                e.stopPropagation();
                if(confirm("Apagar este jogo permanentemente?")) {
                    setGames(games.filter(g => g.id !== id));
                }
            };

            const exportAllData = () => {
                const data = { version: "3.0", timestamp: new Date().toISOString(), teams, games, comps };
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = `ATA_Backup_${new Date().toISOString().split('T')[0]}.json`;
                a.click();
            };

            return React.createElement('div', { className: "flex flex-col h-screen" },
                React.createElement('header', { className: "h-20 glass flex items-center justify-between px-8 shrink-0 z-10 shadow-lg" },
                    React.createElement('div', { className: "flex items-center gap-4" },
                        React.createElement('div', { className: "w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/40 border border-blue-400" }, React.createElement(Activity, { className: "text-white" })),
                        React.createElement('div', null, 
                            React.createElement('h1', { className: "text-xl font-extrabold tracking-tight" }, "AT ANALYZER ", React.createElement('span', { className: "text-blue-500" }, "PRO")),
                            React.createElement('p', { className: "text-[10px] text-slate-400 font-bold uppercase tracking-widest" }, "Sistema EstÃ¡vel v3.0")
                        )
                    ),
                    React.createElement('div', { className: "flex items-center gap-3" },
                        React.createElement(Button, { variant: "secondary", size: "sm", icon: Download, onClick: exportAllData }, "Backup DB"),
                        React.createElement(Button, { variant: "primary", size: "sm", icon: Plus, onClick: () => {
                            if (comps.length === 0 || teams.length < 2) return alert("Cria pelo menos 1 CompetiÃ§Ã£o e 2 Equipas primeiro.");
                            setIsNewGameOpen(true);
                        } }, "Novo Jogo")
                    )
                ),

                React.createElement('main', { className: "flex-1 overflow-y-auto p-8" },
                    React.createElement('div', { className: "max-w-6xl mx-auto" },
                        React.createElement('div', { className: "flex gap-8 border-b border-slate-800 mb-8" },
                            ['games', 'teams', 'comps'].map(tab => React.createElement('button', {
                                key: tab,
                                onClick: () => setActiveTab(tab),
                                className: `pb-4 text-sm font-bold transition-all border-b-2 ${activeTab === tab ? 'text-blue-500 border-blue-500' : 'text-slate-500 border-transparent hover:text-slate-300'}`
                            }, tab === 'games' ? 'Meus Jogos' : tab === 'teams' ? 'Equipas & PlantÃ©is' : 'CompetiÃ§Ãµes'))
                        ),

                        activeTab === 'games' && (
                            sortedGames.length === 0 ? React.createElement('div', { className: "flex flex-col items-center justify-center py-20 bg-slate-900/30 rounded-3xl border border-dashed border-slate-800" },
                                React.createElement(Film, { size: 48, className: "text-slate-700 mb-4" }),
                                React.createElement('p', { className: "text-slate-500 font-medium" }, "Nenhum jogo registado. ComeÃ§a agora!")
                            ) : React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-in fade-in" },
                                sortedGames.map(game => React.createElement(Card, {
                                    key: game.id,
                                    className: "group hover:border-blue-500/50 hover:shadow-blue-900/10 transition-all cursor-pointer",
                                    extra: React.createElement('button', { onClick: (e) => handleDeleteGame(e, game.id), className: "text-slate-600 hover:text-red-500 p-1" }, React.createElement(Trash2, { size: 16 }))
                                }, 
                                    React.createElement('div', { onClick: () => onSelectGame(game.id) },
                                        React.createElement('div', { className: "flex justify-between items-start mb-4" },
                                            React.createElement('span', { className: "text-[10px] font-bold bg-slate-800 text-slate-400 px-2 py-1 rounded" }, game.season),
                                            React.createElement('span', { className: "text-[10px] text-slate-500 flex items-center gap-1 font-mono" }, React.createElement(Calendar, { size: 10 }), game.date)
                                        ),
                                        React.createElement('div', { className: "flex items-center gap-4 mb-4" },
                                            React.createElement('div', { className: "flex-1 text-center" }, 
                                                React.createElement('div', { className: "w-12 h-12 bg-slate-800 rounded-lg mx-auto mb-2 flex items-center justify-center border border-slate-700" }, game.teamA?.logo ? React.createElement('img', { src: game.teamA.logo, className: "w-full p-1 h-full object-contain" }) : React.createElement(Shield, { size: 24, className: "text-slate-600" })),
                                                React.createElement('p', { className: "text-xs font-bold truncate text-slate-200" }, game.teamA?.name || 'Desconhecido')
                                            ),
                                            React.createElement('div', { className: "text-xs font-black text-slate-600 bg-slate-900 px-2 py-1 rounded border border-slate-800" }, "VS"),
                                            React.createElement('div', { className: "flex-1 text-center" }, 
                                                React.createElement('div', { className: "w-12 h-12 bg-slate-800 rounded-lg mx-auto mb-2 flex items-center justify-center border border-slate-700" }, game.teamB?.logo ? React.createElement('img', { src: game.teamB.logo, className: "w-full p-1 h-full object-contain" }) : React.createElement(Shield, { size: 24, className: "text-slate-600" })),
                                                React.createElement('p', { className: "text-xs font-bold truncate text-slate-200" }, game.teamB?.name || 'Desconhecido')
                                            )
                                        ),
                                        React.createElement('div', { className: "pt-4 border-t border-slate-800 flex justify-between items-center" },
                                            React.createElement('div', { className: "flex items-center gap-1 text-[10px] text-slate-500 font-bold" }, React.createElement(Trophy, { size: 12 }), game.compName),
                                            React.createElement('div', { className: "flex items-center gap-1 text-[10px] text-blue-500 font-bold bg-blue-500/10 px-2 py-1 rounded" }, React.createElement(Scissors, { size: 12 }), `${game.clips?.length || 0} Cortes`)
                                        )
                                    )
                                ))
                            )
                        ),

                        activeTab === 'teams' && React.createElement(TeamsManager, { teams, setTeams }),
                        activeTab === 'comps' && React.createElement(CompsManager, { comps, setComps })
                    )
                ),

                React.createElement(Modal, {
                    isOpen: isNewGameOpen,
                    onClose: () => setIsNewGameOpen(false),
                    title: "Criar Novo Jogo"
                }, 
                    React.createElement('div', { className: "p-6 space-y-6" },
                        React.createElement('div', null, 
                            React.createElement('label', { className: "block text-xs font-bold text-slate-400 uppercase mb-2" }, "CompetiÃ§Ã£o"),
                            React.createElement('select', { 
                                className: "w-full bg-slate-900 border border-slate-700 rounded-xl p-3 outline-none focus:border-blue-500 text-slate-200",
                                value: newGame.compId,
                                onChange: e => setNewGame({...newGame, compId: e.target.value})
                            }, 
                                React.createElement('option', { value: "" }, "Selecionar CompetiÃ§Ã£o..."),
                                comps.map(c => React.createElement('option', { key: c.id, value: c.id }, `${c.name} (${c.season})`))
                            )
                        ),
                        React.createElement('div', { className: "grid grid-cols-2 gap-4 bg-slate-900 p-4 rounded-xl border border-slate-800" },
                            React.createElement('div', null, 
                                React.createElement('label', { className: "block text-xs font-bold text-blue-500 uppercase mb-2" }, "Equipa Casa (A)"),
                                React.createElement('select', { 
                                    className: "w-full bg-slate-950 border border-slate-700 rounded-lg p-3 outline-none focus:border-blue-500 text-slate-200",
                                    value: newGame.teamAId,
                                    onChange: e => setNewGame({...newGame, teamAId: e.target.value})
                                }, 
                                    React.createElement('option', { value: "" }, "Selecionar Equipa..."),
                                    teams.map(t => React.createElement('option', { key: t.id, value: t.id }, t.name))
                                )
                            ),
                            React.createElement('div', null, 
                                React.createElement('label', { className: "block text-xs font-bold text-red-500 uppercase mb-2" }, "Equipa Fora (B)"),
                                React.createElement('select', { 
                                    className: "w-full bg-slate-950 border border-slate-700 rounded-lg p-3 outline-none focus:border-red-500 text-slate-200",
                                    value: newGame.teamBId,
                                    onChange: e => setNewGame({...newGame, teamBId: e.target.value})
                                }, 
                                    React.createElement('option', { value: "" }, "Selecionar Equipa..."),
                                    teams.map(t => React.createElement('option', { key: t.id, value: t.id }, t.name))
                                )
                            )
                        ),
                        React.createElement('div', null, 
                            React.createElement('label', { className: "block text-xs font-bold text-slate-400 uppercase mb-2" }, "Data do Jogo"),
                            React.createElement('input', { 
                                type: "date",
                                className: "w-full bg-slate-900 border border-slate-700 rounded-xl p-3 outline-none focus:border-blue-500 text-slate-200 font-mono",
                                value: newGame.date,
                                onChange: e => setNewGame({...newGame, date: e.target.value})
                            })
                        ),
                        React.createElement('div', { className: "pt-4 border-t border-slate-800 flex justify-end gap-3" },
                            React.createElement(Button, { variant: "ghost", onClick: () => setIsNewGameOpen(false) }, "Cancelar"),
                            React.createElement(Button, { variant: "success", icon: PlaySquare, onClick: handleCreateGame }, "Gerar e Analisar")
                        )
                    )
                )
            );
        };

        const TeamsManager = ({ teams, setTeams }) => {
            const [isNewTeamOpen, setIsNewTeamOpen] = useState(false);
            const [editingTeam, setEditingTeam] = useState(null);
            const [newTeam, setNewTeam] = useState({ name: '', logo: '', players: [] });
            
            // Player Editor State
            const [newPlayer, setNewPlayer] = useState({ number: '', name: '' });

            const handleAddTeam = () => {
                if (!newTeam.name) return;
                setTeams([...teams, { id: Date.now().toString(), ...newTeam }]);
                setNewTeam({ name: '', logo: '', players: [] });
                setIsNewTeamOpen(false);
            };

            const handleAddPlayer = () => {
                if (!newPlayer.number || !newPlayer.name || !editingTeam) return;
                const updatedPlayers = [...(editingTeam.players || []), { id: Date.now().toString(), ...newPlayer }];
                const updatedTeam = { ...editingTeam, players: updatedPlayers };
                setEditingTeam(updatedTeam);
                setTeams(teams.map(t => t.id === updatedTeam.id ? updatedTeam : t));
                setNewPlayer({ number: '', name: '' });
            };

            const handleDeletePlayer = (playerId) => {
                const updatedPlayers = editingTeam.players.filter(p => p.id !== playerId);
                const updatedTeam = { ...editingTeam, players: updatedPlayers };
                setEditingTeam(updatedTeam);
                setTeams(teams.map(t => t.id === updatedTeam.id ? updatedTeam : t));
            };

            return React.createElement('div', { className: "space-y-6 animate-in fade-in" },
                React.createElement('div', { className: "flex justify-end" }, 
                    React.createElement(Button, { icon: Plus, onClick: () => setIsNewTeamOpen(true) }, "Adicionar Equipa")
                ),
                React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4" },
                    teams.map(team => React.createElement(Card, { key: team.id, title: team.name, icon: Shield },
                        React.createElement('div', { className: "text-center py-4" },
                            React.createElement('div', { className: "w-16 h-16 bg-slate-800 rounded-2xl mx-auto mb-4 flex items-center justify-center border border-slate-700 overflow-hidden" },
                                team.logo ? React.createElement('img', { src: team.logo, className: "w-full p-2 h-full object-contain" }) : React.createElement(Shield, { size: 32, className: "text-slate-600" })
                            ),
                            React.createElement('p', { className: "text-xs font-bold text-slate-400 bg-slate-800 inline-block px-3 py-1 rounded-full border border-slate-700" }, `${team.players?.length || 0} Atletas`),
                            React.createElement('div', { className: "mt-6 flex gap-2 justify-center" },
                                React.createElement(Button, { size: "sm", variant: "secondary", icon: Users, onClick: () => setEditingTeam(team) }, "Plantel"),
                                React.createElement(Button, { size: "sm", variant: "ghost", icon: Trash2, onClick: () => { if(confirm(`Apagar equipa ${team.name}?`)) setTeams(teams.filter(t => t.id !== team.id)) } })
                            )
                        )
                    ))
                ),

                // Modal Criar Equipa
                React.createElement(Modal, { isOpen: isNewTeamOpen, onClose: () => setIsNewTeamOpen(false), title: "Nova Equipa" },
                    React.createElement('div', { className: "p-6 space-y-4" },
                        React.createElement('input', { placeholder: "Nome da Equipa", className: "w-full bg-slate-900 border border-slate-700 p-3 rounded-lg text-slate-200 outline-none focus:border-blue-500", value: newTeam.name, onChange: e => setNewTeam({...newTeam, name: e.target.value}) }),
                        React.createElement('input', { placeholder: "URL do Logo (Opcional)", className: "w-full bg-slate-900 border border-slate-700 p-3 rounded-lg text-slate-200 outline-none focus:border-blue-500", value: newTeam.logo, onChange: e => setNewTeam({...newTeam, logo: e.target.value}) }),
                        React.createElement(Button, { className: "w-full", onClick: handleAddTeam, variant: "success" }, "Guardar Equipa")
                    )
                ),

                // Modal Editar Plantel (Crucial para nÃ£o haver "telas presas")
                React.createElement(Modal, { isOpen: !!editingTeam, onClose: () => setEditingTeam(null), title: `Plantel: ${editingTeam?.name}` },
                    React.createElement('div', { className: "p-6 flex flex-col h-[60vh]" },
                        React.createElement('div', { className: "flex gap-2 mb-6 bg-slate-900 p-4 rounded-xl border border-slate-800" },
                            React.createElement('input', { 
                                placeholder: "NÂº", type: "number",
                                className: "w-20 bg-slate-950 border border-slate-700 p-3 rounded-lg text-slate-200 outline-none focus:border-blue-500 font-mono text-center", 
                                value: newPlayer.number, onChange: e => setNewPlayer({...newPlayer, number: e.target.value}) 
                            }),
                            React.createElement('input', { 
                                placeholder: "Nome do Atleta", 
                                className: "flex-1 bg-slate-950 border border-slate-700 p-3 rounded-lg text-slate-200 outline-none focus:border-blue-500", 
                                value: newPlayer.name, onChange: e => setNewPlayer({...newPlayer, name: e.target.value}) 
                            }),
                            React.createElement(Button, { onClick: handleAddPlayer, variant: "primary", icon: Plus }, "Adicionar")
                        ),
                        React.createElement('div', { className: "flex-1 overflow-y-auto space-y-2 pr-2" },
                            (editingTeam?.players || []).length === 0 ? React.createElement('p', { className: "text-center text-slate-500 py-10" }, "Nenhum jogador registado na equipa.") :
                            (editingTeam?.players || []).map(p => React.createElement('div', { key: p.id, className: "flex justify-between items-center bg-slate-800 p-3 rounded-lg border border-slate-700" },
                                React.createElement('div', { className: "flex items-center gap-4" },
                                    React.createElement('span', { className: "w-8 h-8 flex items-center justify-center bg-slate-900 rounded-full font-mono font-bold text-blue-400 text-sm border border-slate-700" }, p.number),
                                    React.createElement('span', { className: "font-bold text-slate-200" }, p.name)
                                ),
                                React.createElement('button', { onClick: () => handleDeletePlayer(p.id), className: "text-slate-500 hover:text-red-500 p-2" }, React.createElement(Trash2, { size: 16 }))
                            ))
                        )
                    )
                )
            );
        };

        const CompsManager = ({ comps, setComps }) => {
            const [isNewCompOpen, setIsNewCompOpen] = useState(false);
            const [newComp, setNewComp] = useState({ name: '', season: '2023/24' });

            return React.createElement('div', { className: "space-y-6 animate-in fade-in" },
                React.createElement('div', { className: "flex justify-end" }, 
                    React.createElement(Button, { icon: Plus, onClick: () => setIsNewCompOpen(true) }, "Nova CompetiÃ§Ã£o")
                ),
                React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" },
                    comps.map(c => React.createElement(Card, { key: c.id, title: c.name, icon: Trophy },
                        React.createElement('p', { className: "text-sm text-slate-400 font-bold bg-slate-800 inline-block px-3 py-1 rounded border border-slate-700" }, c.season),
                        React.createElement('div', { className: "mt-4 flex justify-end" },
                             React.createElement(Button, { size: "sm", variant: "ghost", icon: Trash2, onClick: () => { if(confirm("Apagar?")) setComps(comps.filter(co => co.id !== c.id)) } })
                        )
                    ))
                ),
                React.createElement(Modal, { isOpen: isNewCompOpen, onClose: () => setIsNewCompOpen(false), title: "Nova CompetiÃ§Ã£o" },
                    React.createElement('div', { className: "p-6 space-y-4" },
                        React.createElement('input', { placeholder: "Nome do Campeonato (ex: 1Âª DivisÃ£o)", className: "w-full bg-slate-900 border border-slate-700 p-3 rounded-lg text-slate-200 outline-none", value: newComp.name, onChange: e => setNewComp({...newComp, name: e.target.value}) }),
                        React.createElement('input', { placeholder: "Ã‰poca (ex: 2023/24)", className: "w-full bg-slate-900 border border-slate-700 p-3 rounded-lg text-slate-200 outline-none", value: newComp.season, onChange: e => setNewComp({...newComp, season: e.target.value}) }),
                        React.createElement(Button, { className: "w-full", variant: "success", onClick: () => { if(newComp.name) { setComps([...comps, {id: Date.now().toString(), ...newComp}]); setIsNewCompOpen(false); setNewComp({name:'', season:'2023/24'}); } } }, "Criar CompetiÃ§Ã£o")
                    )
                )
            );
        };

        // =========================================================================
        // ðŸŽ¬ ANALYZER VIEW (O NÃšCLEO DA APLICAÃ‡ÃƒO)
        // =========================================================================
        const Analyzer = ({ gameId, storage, onBack }) => {
            const { games, setGames } = storage;
            const game = useMemo(() => games.find(g => g.id === gameId), [games, gameId]);
            
            const [videoSrc, setVideoSrc] = useState(null);
            const [isPlaying, setIsPlaying] = useState(false);
            const [currentTime, setCurrentTime] = useState(0);
            const [duration, setDuration] = useState(0);
            
            const [inPoint, setInPoint] = useState(null);
            const [isModalOpen, setIsModalOpen] = useState(false);
            
            const [activeTeam, setActiveTeam] = useState('A'); // 'A' or 'B'
            const [currentTags, setCurrentTags] = useState([]);
            const [selectedPlayerIds, setSelectedPlayerIds] = useState([]);
            
            const videoRef = useRef(null);

            // Prevenir Memory Leaks com ficheiros de vÃ­deo enormes
            useEffect(() => {
                return () => {
                    if (videoSrc) URL.revokeObjectURL(videoSrc);
                };
            }, [videoSrc]);

            const togglePlay = () => {
                if (!videoRef.current) return;
                if (videoRef.current.paused) {
                    videoRef.current.play().catch(e => console.error("Erro ao reproduzir", e));
                    setIsPlaying(true);
                } else {
                    videoRef.current.pause();
                    setIsPlaying(false);
                }
            };

            const togglePlayer = (id) => {
                setSelectedPlayerIds(prev => prev.includes(id) ? prev.filter(pid => pid !== id) : [...prev, id]);
            };

            const toggleTag = (tag) => {
                setCurrentTags(prev => prev.includes(tag) ? prev.filter(t => t !== tag) : [...prev, tag]);
            };

            const handleSaveClip = () => {
                if (!videoRef.current) return;
                const outPoint = videoRef.current.currentTime;
                
                // Tratar caso o utilizador nÃ£o tenha feito Z (Ponto IN)
                const finalInPoint = inPoint !== null ? inPoint : Math.max(0, outPoint - 6);

                const newClip = {
                    id: Date.now().toString(),
                    start: finalInPoint,
                    end: outPoint,
                    team: activeTeam,
                    tags: currentTags,
                    playerIds: selectedPlayerIds
                };

                const updatedGames = games.map(g => g.id === gameId ? { ...g, clips: [...(g.clips || []), newClip] } : g);
                setGames(updatedGames);
                
                // Reset state
                setIsModalOpen(false);
                setInPoint(null);
                setCurrentTags([]);
                setSelectedPlayerIds([]);
                
                // Retoma vÃ­deo
                videoRef.current.play().catch(e => console.log(e));
                setIsPlaying(true);
            };

            if (!game) return React.createElement('div', { className: "p-10 text-center text-red-500" }, "Erro CrÃ­tico: Jogo nÃ£o encontrado.");

            const activePlayers = activeTeam === 'A' ? (game.teamA?.players || []) : (game.teamB?.players || []);

            return React.createElement('div', { className: "flex flex-col h-screen overflow-hidden animate-in fade-in" },
                // Header Analyzer
                React.createElement('header', { className: "h-16 glass flex items-center justify-between px-6 shrink-0 z-10 border-b border-slate-800" },
                    React.createElement('div', { className: "flex items-center gap-4" },
                        React.createElement('button', { onClick: onBack, className: "p-2 hover:bg-slate-800 rounded-lg text-slate-400 transition-colors bg-slate-900 border border-slate-700" }, React.createElement(ChevronLeft, { size: 20 })),
                        React.createElement('div', { className: "w-px h-6 bg-slate-700" }),
                        React.createElement('div', null,
                            React.createElement('h2', { className: "text-sm font-bold text-slate-200" }, `${game.teamA?.name} vs ${game.teamB?.name}`),
                            React.createElement('p', { className: "text-[10px] text-blue-400 uppercase font-bold" }, game.compName)
                        )
                    ),
                    React.createElement('div', { className: "flex items-center gap-2" },
                        React.createElement('input', { 
                            type: "file", id: "v-upload", className: "hidden", 
                            accept: "video/mp4,video/mkv,video/avi", 
                            onChange: (e) => {
                                const file = e.target.files[0];
                                if(file) {
                                    if(videoSrc) URL.revokeObjectURL(videoSrc);
                                    setVideoSrc(URL.createObjectURL(file));
                                    setIsPlaying(false);
                                }
                            }
                        }),
                        React.createElement(Button, { variant: "primary", size: "sm", icon: FileVideo, onClick: () => document.getElementById('v-upload').click() }, videoSrc ? "Trocar VÃ­deo" : "Carregar VÃ­deo mp4")
                    )
                ),

                // Workspace Principal
                React.createElement('div', { className: "flex-1 flex overflow-hidden bg-slate-950" },
                    
                    // Zona do VÃ­deo
                    React.createElement('div', { className: "flex-1 flex flex-col p-4 gap-4" },
                        React.createElement('div', { className: "flex-1 bg-black rounded-2xl overflow-hidden relative shadow-2xl border border-slate-800 flex items-center justify-center" },
                            videoSrc ? React.createElement('video', {
                                ref: videoRef,
                                src: videoSrc,
                                className: "w-full h-full object-contain",
                                onClick: togglePlay,
                                onTimeUpdate: () => setCurrentTime(videoRef.current?.currentTime || 0),
                                onLoadedMetadata: () => setDuration(videoRef.current?.duration || 0)
                            }) : React.createElement('div', { className: "flex flex-col items-center justify-center text-slate-700" }, 
                                React.createElement(Film, { size: 64, className: "mb-4 opacity-30" }),
                                React.createElement('p', { className: "font-bold text-slate-500 uppercase tracking-widest text-sm" }, "Aguardando Ficheiro de VÃ­deo")
                            ),
                            
                            // Indicador de Ponto IN
                            inPoint !== null && React.createElement('div', { className: "absolute top-6 left-6 flex items-center gap-2 bg-emerald-600 text-white px-4 py-2 rounded-lg text-xs font-black shadow-lg shadow-emerald-900/50 animate-pulse border border-emerald-400" }, 
                                React.createElement('div', { className: "w-2 h-2 bg-white rounded-full" }),
                                `CORTE INICIADO: ${formatTime(inPoint)}`
                            )
                        ),

                        // Timeline Controls
                        React.createElement('div', { className: "h-auto glass rounded-2xl p-4 flex flex-col gap-3 border border-slate-800" },
                            React.createElement('input', { 
                                type: "range", className: "w-full focus:outline-none",
                                min: 0, max: duration || 100, step: 0.1, value: currentTime,
                                onChange: (e) => { 
                                    const val = parseFloat(e.target.value);
                                    setCurrentTime(val);
                                    if(videoRef.current) videoRef.current.currentTime = val; 
                                }
                            }),
                            React.createElement('div', { className: "flex items-center justify-between" },
                                React.createElement('div', { className: "flex items-center gap-4" },
                                    React.createElement('button', { onClick: togglePlay, className: "w-12 h-12 bg-blue-600 hover:bg-blue-500 rounded-full flex items-center justify-center transition-transform active:scale-90 text-white shadow-lg shadow-blue-900/50" }, 
                                        isPlaying ? React.createElement(Pause, { size: 24, fill: "currentColor" }) : React.createElement(Play, { size: 24, fill: "currentColor", className: "ml-1" })
                                    ),
                                    React.createElement('div', { className: "bg-slate-900 px-3 py-1.5 rounded-lg border border-slate-700" },
                                        React.createElement('span', { className: "text-sm font-mono font-bold text-blue-400" }, formatTime(currentTime)),
                                        React.createElement('span', { className: "text-sm font-mono text-slate-600 mx-1" }, "/"),
                                        React.createElement('span', { className: "text-sm font-mono text-slate-400" }, formatTime(duration))
                                    )
                                ),
                                React.createElement('div', { className: "flex gap-3" },
                                    React.createElement('button', { 
                                        onClick: () => { if(!videoRef.current) return; setInPoint(videoRef.current.currentTime); },
                                        className: `px-6 py-2 rounded-xl font-bold text-sm transition-all active:scale-95 shadow-lg ${inPoint !== null ? 'bg-emerald-600 text-white border border-emerald-500 shadow-emerald-900/50' : 'bg-slate-800 text-slate-300 border border-slate-700 hover:bg-slate-700'}`
                                    }, "Z: INÃCIO DO LANCE"),
                                    React.createElement('button', { 
                                        onClick: () => { if(!videoRef.current) return; videoRef.current.pause(); setIsPlaying(false); setIsModalOpen(true); },
                                        className: "px-6 py-2 bg-red-600 hover:bg-red-500 text-white rounded-xl font-bold text-sm shadow-lg shadow-red-900/50 border border-red-500 transition-all active:scale-95" 
                                    }, "X: CORTAR & AVALIAR")
                                )
                            )
                        )
                    ),

                    // Sidebar Lista de Cortes Segura
                    React.createElement('aside', { className: "w-80 border-l border-slate-800 flex flex-col glass z-10" },
                        React.createElement('div', { className: "p-4 border-b border-slate-800 bg-slate-900" },
                            React.createElement('h3', { className: "text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2" }, React.createElement(ListVideo, { size: 14 }), "HistÃ³rico de Cortes")
                        ),
                        React.createElement('div', { className: "flex-1 overflow-y-auto p-4 space-y-3 bg-slate-950/50" },
                            (game.clips || []).length === 0 ? React.createElement('div', { className: "text-center mt-10 opacity-50" }, React.createElement(Scissors, { size: 32, className: "mx-auto mb-2 text-slate-600" }), React.createElement('p', { className: "text-xs text-slate-500 font-bold" }, "Sem cortes registados")) :
                            (game.clips || []).map(clip => React.createElement('div', { 
                                key: clip.id, 
                                onClick: () => { if(videoRef.current) { videoRef.current.currentTime = clip.start; videoRef.current.play(); setIsPlaying(true); } },
                                className: "bg-slate-900 border border-slate-800 rounded-xl p-3 hover:border-blue-500 transition-all cursor-pointer relative group overflow-hidden" 
                            },
                                React.createElement('div', { className: `absolute left-0 top-0 bottom-0 w-1.5 ${clip.team === 'A' ? 'bg-blue-500' : 'bg-red-500'}` }),
                                React.createElement('div', { className: "flex justify-between items-start mb-2 pl-2" },
                                    React.createElement('span', { className: "text-[11px] font-mono text-slate-300 font-bold bg-slate-950 px-2 py-0.5 rounded border border-slate-800" }, `${formatTime(clip.start)} - ${formatTime(clip.end)}`),
                                    React.createElement('button', { 
                                        onClick: (e) => { e.stopPropagation(); setGames(games.map(g => g.id === gameId ? {...g, clips: g.clips.filter(c => c.id !== clip.id)} : g)) },
                                        className: "text-slate-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-950 p-1 rounded"
                                    }, React.createElement(Trash2, { size: 14 }))
                                ),
                                React.createElement('div', { className: "flex flex-wrap gap-1.5 pl-2" },
                                    (clip.tags || []).slice(0, 4).map(t => React.createElement('span', { key: t, className: "text-[9px] bg-slate-800 px-1.5 py-0.5 rounded text-slate-300 font-bold" }, t))
                                )
                            ))
                        )
                    )
                ),

                // Modal de ClassificaÃ§Ã£o (Tagging)
                React.createElement(Modal, {
                    isOpen: isModalOpen,
                    onClose: () => { setIsModalOpen(false); if(videoRef.current) videoRef.current.play(); setIsPlaying(true); },
                    title: "Classificar Lance Furtado",
                    maxWidth: "max-w-4xl"
                }, 
                    React.createElement('div', { className: "p-6 grid grid-cols-1 md:grid-cols-2 gap-8" },
                        React.createElement('div', { className: "space-y-6" },
                            // Equipa Ativa
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-[10px] font-black text-slate-500 uppercase mb-3 flex items-center gap-1" }, React.createElement(Shield, { size: 12 }), "Equipa Ativa no Lance"),
                                React.createElement('div', { className: "flex gap-2" },
                                    React.createElement('button', { 
                                        onClick: () => setActiveTeam('A'),
                                        className: `flex-1 py-3 rounded-xl border-2 font-bold transition-all ${activeTeam === 'A' ? 'bg-blue-900/30 border-blue-500 text-blue-400 shadow-inner' : 'bg-slate-900 border-slate-800 text-slate-500 hover:bg-slate-800'}`
                                    }, game.teamA?.name),
                                    React.createElement('button', { 
                                        onClick: () => setActiveTeam('B'),
                                        className: `flex-1 py-3 rounded-xl border-2 font-bold transition-all ${activeTeam === 'B' ? 'bg-red-900/30 border-red-500 text-red-400 shadow-inner' : 'bg-slate-900 border-slate-800 text-slate-500 hover:bg-slate-800'}`
                                    }, game.teamB?.name)
                                )
                            ),
                            
                            // Jogadores da Equipa Ativa
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-[10px] font-black text-slate-500 uppercase mb-3 flex items-center gap-1" }, React.createElement(Users, { size: 12 }), "Jogadores Intervenientes"),
                                React.createElement('div', { className: "flex flex-wrap gap-2 max-h-32 overflow-y-auto p-2 bg-slate-900/50 rounded-xl border border-slate-800" },
                                    activePlayers.length === 0 ? React.createElement('span', { className: "text-xs text-slate-500 italic" }, "Sem jogadores registados no plantel.") :
                                    activePlayers.map(p => React.createElement(TagButton, {
                                        key: p.id,
                                        label: `${p.number} - ${p.name.split(' ')[0]}`,
                                        selected: selectedPlayerIds.includes(p.id),
                                        onClick: () => togglePlayer(p.id),
                                        color: activeTeam === 'A' ? 'blue' : 'red'
                                    }))
                                )
                            ),

                            // Tags GenÃ©ricas
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-[10px] font-black text-slate-500 uppercase mb-3 flex items-center gap-1" }, React.createElement(Tag, { size: 12 }), "Tags do Evento"),
                                React.createElement('div', { className: "space-y-4" },
                                    Object.entries(staticCategories).map(([cat, items]) => (
                                        React.createElement('div', { key: cat },
                                            React.createElement('span', { className: "text-[9px] text-slate-600 font-bold uppercase mb-1 block" }, cat),
                                            React.createElement('div', { className: "flex flex-wrap gap-1.5" },
                                                items.map(item => React.createElement(TagButton, {
                                                    key: item, label: item,
                                                    selected: currentTags.includes(item),
                                                    onClick: () => toggleTag(item),
                                                    color: cat === 'Resultado' ? 'green' : (cat === 'Turn Over' ? 'red' : 'blue')
                                                }))
                                            )
                                        )
                                    ))
                                )
                            )
                        ),
                        React.createElement('div', { className: "space-y-6 flex flex-col" },
                            // Heatmap Clickable
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-[10px] font-black text-slate-500 uppercase mb-3 flex items-center gap-1" }, React.createElement(MapPin, { size: 12 }), "Zona de FinalizaÃ§Ã£o"),
                                React.createElement('div', { className: "grid grid-cols-4 gap-1.5 mb-3" },
                                    zones.map(z => React.createElement('button', {
                                        key: z, onClick: () => toggleTag(z),
                                        className: `py-2 rounded-lg text-[10px] font-bold border transition-colors ${currentTags.includes(z) ? 'bg-amber-500 border-amber-400 text-slate-900 shadow-lg shadow-amber-900/50' : 'bg-slate-900 border-slate-700 text-slate-400 hover:border-amber-500/50 hover:text-amber-400'}`
                                    }, z.replace("Zona ", "Z")))
                                ),
                                React.createElement('div', { className: "pointer-events-none opacity-50" },
                                    React.createElement(StatsCourt, { zoneStats: currentTags.reduce((acc, t) => zones.includes(t) ? {...acc, [t]: {shots: 1, goals: currentTags.includes("Golo") ? 1 : 0, efficiency: currentTags.includes("Golo") ? 1 : 0}} : acc, {}) })
                                )
                            ),
                            
                            // BotÃ£o de Gravar
                            React.createElement('div', { className: "mt-auto pt-6" },
                                React.createElement(Button, { className: "w-full py-4 text-lg", variant: "primary", icon: Save, onClick: handleSaveClip }, "Guardar Corte na Base de Dados")
                            )
                        )
                    )
                )
            );
        };

        // =========================================================================
        // ðŸš€ ROOT APP
        // =========================================================================
        function App() {
            const storage = useStorage();
            const [view, setView] = useState('dashboard');
            const [selectedGameId, setSelectedGameId] = useState(null);

            const navigateToGame = (id) => {
                setSelectedGameId(id);
                setView('analyzer');
            };

            // Error Boundary de topo simples
            try {
                if (view === 'dashboard') return React.createElement(Dashboard, { storage, onSelectGame: navigateToGame });
                if (view === 'analyzer') return React.createElement(Analyzer, { gameId: selectedGameId, storage, onBack: () => setView('dashboard') });
            } catch (error) {
                console.error("Critical Error", error);
                return React.createElement('div', { className: "p-10 flex flex-col items-center justify-center h-screen bg-slate-950 text-white" }, 
                    React.createElement(AlertTriangle, { size: 64, className: "text-red-500 mb-4" }),
                    React.createElement('h1', { className: "text-2xl font-bold mb-2" }, "Ocorreu um Erro CrÃ­tico"),
                    React.createElement('p', { className: "text-slate-400 mb-6" }, "Os teus dados estÃ£o seguros, mas a interface quebrou."),
                    React.createElement(Button, { onClick: () => window.location.reload() }, "Recarregar AplicaÃ§Ã£o")
                );
            }
            return null;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
